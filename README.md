ECE251a Homework 07

#1 (textbook exercise 4.1)
Consider the following instruction:
Instruction: and rd, rsl, rs2
Interpretation: Reg[rd] = Reg[rs1] AND Reg[rs2]


#1.a <§4.3> What are the values of control signals generated by the control in Figure 4.10 for this instruction?
RegDst = 1
ALUSrc = 0
MemtoReg = 0
RegWrite = 1
MemRead = 0
MemWrite = 0
ALUOp = 10

#1.b <§4.3> Which resources (blocks) perform a useful function for this instruction?
The program counter holds the address of the instruction being executed. The instruction memory supplies the binary encoding of the instruction at the address from the PC. The register file reads contents of rs1 and rs2, allowing it to write into rd. The ALU performs the AND operation on the two register values, where the ALU control will choose that operation. The mux going into the ALU chooses between a register and an immediate value as the second input into the ALU. The mux that goes into the register file chooses whether the destination register comes from the I type or R type.

#1.c <§4.3> Which resources (blocks) produce no output for this instruction? Which resources produce output that is not used?
Sign-Extend produces no output. The data memory does not store or load instructions.

#2 (textbook exercise 4.5)
In this exercise, we examine in detail how an instruction is executed in a single-cycle datapath. Problems in this exercise refer to a clock cycle in which the processor fetches the following instruction word: 0x00c6ba23.


#2.a <§4.4> What are the values of the ALU control unit’s inputs for this instruction?
ALUOp = 10
funct field = 10010
ALU control = 0110

#2.b <§4.4> What is the new PC address after this instruction is executed? Highlight the path through which this value is determined.
PC + 4; PC --> ALU input A, Constant 4 --> ALU input B via mux, ALU performs add, Output --> PC via mux, PCWrite = 1

#2.d <§4.4> For each mux, show the values of its inputs and outputs during the execution of this instruction. List values that are register outputs at Reg [xn].
MUX	        Inputs	                                                    Output
ALUSrc	    0: Reg[22] = $22, 1: Sign-extended immediate (not used)	    Output: Reg[22]
RegDst	    0: rt (22), 1: rd (15)	                                    Output: 15 (write to $15)
MemtoReg	0: ALU result, 1: memory read result	                    Output: ALU result
PCSrc	   00: ALU result (PC+4), 01: branch target, 10: jump address   Output: PC + 4

#2.e  <§4.4> What are the input values for the ALU and the two add units?
ALU inputs:
A = Reg[12]
B = Reg[22]
ALU Control = 0110 

Adder 1 (PC + 4):
Input 1 = PC
Input 2 = 4
Output = New PC address

Adder 2:
Not used

#2.f  <§4.4> What are the values of all inputs for the registers unit?
Input	            Value
Read register 1	    rs = 12
Read register 2	    rt = 22
Write register	    rd = 15 (selected via RegDst = 1)
Write data	        ALU result (Reg[12] - Reg[22])
RegWrite	        1 (enabled for R-type instructions)

#3 (textbook exercise 4.12)
Examine the difficulty of adding a proposed swap rs, rt instruction to MIPS.
Interpretation: Reg[rt] = Reg[rs]; Reg[rs] = Reg[rt]

#3.a <§4.4> Which new functional blocks (if any) do we need for this instruction?
Additional temporary register to hold one of the values between reads and writes.

#3.b <§4.4> Which existing functional blocks (if any) require modification?
Register file must be modified to support 2 simultaneous writes. The control unit controls two write enables and two destinations. 

#3.c <§4.4> What new data paths do we need (if any) to support this instruction?
A path to Reg[rs] to be stored temporarily, then routed back into Reg[rt]. A second write data path to the register file for Reg[rs]

#3.d <§4.4> What new signals do we need (if any) from the control unit to support this instruction?
Signal	               Purpose
RegWrite2	           Enable second register write
WriteReg1 selector	   Select register to receive first write (e.g., rs)
WriteReg2 selector	   Select register to receive second write (e.g., rt)
WriteData2 control	   Select correct data to send to second register

#3.e <§4.4> Modify Figure 4.21 in Chapter 4 to demonstrate an implementation of this new instruction.
There must be a second write back path required to link the ALU result to second write register port. A temporary register is required to hold Reg[rs] for writing into Reg[rt]. There must be a second write port on the register file. There must also be additional control signals: RegWrite2, WriteReg2, WriteData2. Read data 1 should be held in a temporary register and Read data 2 written to Reg[rs]. 